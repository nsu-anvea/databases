# Generalized Tabular Expressions and Composite Queries

## Tasks

1. Посчитать среднюю зарплату работников, работающих на должности с наибольшим разбросом между минимальным и максимальным порогом зарплаты (min\_salary, max\_salary). Если таких должностей несколько, то посчитать среднюю зарплату для каждой из них.    
   **Вывести**: код должности, средняя зарплата.   
   **Сортировать**: код должности. 

2. Отобразить список всех работников, которые работают в двух странах с наименьшим суммарным заработком сотрудников    
   **Вывести**: код сотрудника.   
   **Сортировать**: код сотрудника. 

3. Разбить все зарплаты на 4 уровня: 0-5000, \>5000-10000, \>10000 \- 15000, \>15001-1000000. Для каждого определить: количество работников, суммарную зарплату, среднюю зарплату, количество различных должностей у сотрудников в группе.    
   **Вывести**: номер группы, количество работников, суммарная зарплата, средняя зарплата, количество различных должностей;   
   **Сортировать**: номер группы

4. Посчитать среднюю зарплату работников, работающих на должности с наименьшим разбросом между минимальным и максимальным порогом зарплаты (`min_salary`, `max_salary`). Если таких должностей несколько, то посчитать среднюю зарплату для каждой из них.    
   **Вывести**: код должности, средняя зарплата работников по данной должности;  
   **Сортировка**: код должности

5. Среди однофамильцев выбрать работника с зарплатой выше средней по его отделу. Если у человека нет однофамильцев, в результат его не выводить    
   **Вывести**: фамилия, код работника, зарплата.  
   **Сортировка**: фамилия, код работника

6. Среди первых трех самых высокооплачиваемых сотрудников отобрать того, у которого больше всего подчиненных    
   **Вывести**: код работника.  
   **Сортировка**: код работника

7. Среди первых трех лидирующих по количеству подчиненных менеджеров выбрать менеджера с наименьшим стажем.    
   **Вывести**: код работника.  
   **Сортировка**: код работника.

8. Среди работников, у которых разница зарплаты с их менеджером менее 5000 выбрать того, который был трудоустроен раньше остальных    
   **Вывести**: фамилия сотрудника, имя 

9. Из страны, в которой проживает сотрудник с наибольшим стажем (если таких несколько, то рассмотреть страну для каждого из них), выбрать работника, с наибольшей зарплатой его подчиненных.    
   **Вывести**: ИД работника;   
   **Сортировка**: ИД работника

10. Вывести названия всех отделов, в которых наименьшая зарплата выше средней зарплаты в Америке(region\_name \= "Americas")    
    **Вывести**: Название отдела  
    **Сортировка**: Название отдела
